/*
 ++******%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
++**#***%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#*%%@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@
++*****##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#@@@%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+******##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*+***+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%
++*****##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####**#%*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#@@@@%##%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%@
=+***####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##*+*###%#*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#@@%#%%#######%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
=++**####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%####**%%%@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*%@#%%##%##**##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+++**###%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#***#**#**##*#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##%%#%%#%###****##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@
++++*###%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#***+*#*****#%*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%@#%%########%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@%
**++**##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**#***+*###%####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#@@@@%#####********#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@
**+***###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**+++***#####%#%#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*#@@@%#*%###**#%%%%@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
******##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##*****#####%%%%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##@@@@##%%%#####%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***#####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##******##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%#**********#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***#####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%***+**######%@@@@@@@@@@@@@@@@@@@@@%#%@%@%%@@@@@@%%@@%%@@@@@%@@%@@@@@%%%%%#############%#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@
***#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@***+*####%%%#@%@@%@@@%%%#%#%%%#%@@#+*%@%%@%@@%#**##@@%@%%@@@@@@@@%@@@@@%%#%%%#########%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***#####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##*****###%%%@@@%##*##%@@%*+*+=+#@@%+*@@%#%%%@#*#@@@*+++*#%%%%%%%@@@@@#%%%#####***##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***#####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*##****#%@@@#++==*#%@@@@*==++***@@@@%#@@@%@@@@@@@#+**=+*##@@@@#+++*#@@@@##*#####%%%##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***###%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#++*#%@%%%%#+=====*%@@@@*+*+*+**###**###%@***#%@%#*+*+***#@@@@%#++++*#%@%%%#**####*#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#%%@%%%#*++=+===+++#%@@%*+*+#+++***+*#*##%%%##***###*****%@@@@#+====++*%%%@@%##%#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***###%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@%#**###%%%#+*+-=++*****+*+#*********##%#+##*#*#%####****%%#*+=+**+*+##%###%%@@%%%@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@
++*###%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**%@@@@@@@@@@@@@#***+==+=+*%*#**+**+**++*=*#***%%#***+=+++*++*#@@@@@@@@@@%###@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+++*###%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#*#%@@@@@@@@@@@@@@@@@#++====++*#*+++*****+##**###*#*++====+*%@@@@@@@@@@@@@@@@%*#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
=++**###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@%@@@@@@@@@@@@@@%@@@@@%+==--+#*+*#**#*##%+***+**##*=-=-+*@@@@@@@@@@@@@@@@@@@@####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
++++****#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#*+=-+@@%#@@@@@@@@@@@@@@@@@*=--=***+**###*%#*#%****#*--=-=%@@@@@%@@@%@@@@@@@@@@%%%%@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+*****###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*+++---=@@@+%@@@@@@@@@@@@@@@@#=--+**+++**##%%@%###++*#+-:-+@@#*%@@@@@@@@@@@@@##@@+-====+%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%
+****##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@%*==---=#@@##@@@@@@@@@@#%@@@%+==**+++****##*@##**++***=-=+@@@**%@@@@@@@@@@@@*@@#=-===**#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%#%%%#*+---=#@@%#%@@%#*#@@@@@@*+##**#****+*++*+*****+***++%@@@@#*#%@@@@@@@@#@@@+---=+*##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@%#**+#%#%%*==----:---=+=+%%@@@%##*****++++++++++**##*##@@@@@@@######*+#@%*+=====+*%%##@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#**#%#%*#*******++=---==#@@@@**%###**+++++++++=++****#%#%@@@@@@*++===--===*+**#%#%###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#**#%%##****%%%@#####%++*#%%@@#*%@%#%*#*++***+++++*+++***%@@@%@@@@@%*+==+**###**##**##%@@%@%#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+*#***#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#++##**#@@@@@@####%%%%###=*%#%@#*#%#%%@#*#%##***+*****###**#%@@%#+%@@%#*###%#%%%#@@%%#%@@@@@#**%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+*****####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**#%%@@%*+#@@%%%####%%#%%%***++**#+*+#@@@@@@@@%%%%%%%@%%@@@%%%******#%%#*****@#%%%@@%@@@%#*+*###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+***#**###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@%#**#%@@@@@@@@@%#%%%##*##+****+++++#%@@@@@%%%####*#####%%@@@@@%#*++*+==+*######@@%%%@@%%#*#%%%%#*++*%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+***#***##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%##%@@@@@@%%%%%@@@#++**###%*%#++++====+*@@@@@@@@%%%#####%%%@@@@@@@%+++++++*****+#%%#**%@@@@@@@@@@@%%##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+***#*+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%##*++****##%%%%**####%%#@@#*%*=====---=#@@@@@@@%%%%@%@@@@@@%+++=-==++*++*####@#***#%@@@%#***%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+*****+*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####++====+***###@@@@%+=++=++*+======-:::--*@@@@@@@@@@@@@%*=---:-==-=+#@##@@%%@@####%@%%#****##*#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+*++++*####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**#%#####**+**#%%#++++==#%#+**====----:::-:+@@@@@@@@@@@#-:--::----=+++++======+*@@#*#******++*%@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+++=+*#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%**+******#*+++*#*+=+*#*=++++====--==-----::-=%@@@@@@@@+----:-------=+**++%%#%@%#***###%%%###%%@%###@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+===+*#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*++++==+++=++++++*###*******=++===----=====+++%@@@@@#**=====--===---===++===+++*%%#****#%##%%%****@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
===++*#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@%#%*+==--===+==+**##*++++==+-====+===+++==+==-=++##@@%#**+====++++====+**++######*+++++****+**++++**#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
==++++*####%@@@@@@@@@@@@@@@@@@@@@@@@@@%#%@%#*+*+=========+++=-+##*++*##**++++====+=++++**#@@%#+**+++=======++=====++++=+++==+++*++++===+++#@%*%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-=+*++*####%%@@@@@@@@@@@@@@@@@@@@@@@@%#%@@@#%@%#*=--===--==+++*##%%%%%%%##*+++++*###%%%%%@@@@@@%%@%**++++++*#%#***##**+**+=============+***##*#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-=+**+*####%%@@@@@@@@@@@@@@@@@@@@@@@%*%@@%**++++****++++++==+***###%%###%########%##***++*******#*#%%%%%*##%%%%@%%##*+==============++++#%@@%**%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
==+**+*#####%@@@@@@@@@@@@@@@@@@@@@@@#%@@*++++*###**######**##*###*###########*******+++++=++++*=++++*****###%%#**++++==========++***++=+#@%@@**#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
==+**++#####%@@@@@@@@@@@@@@@@@@@@@@@#%@%*++****###****+**#**########%%%%##%%####******++++***+*+++++*###*##***++*++++***************###*#**#%%%#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+++**++#####%%@@@@@@@@@@@@@@@@@@@@@@%%%**++++*###**+++++++++++**######%%%%#######%%#%%######%***%#########***++*+++++++++++++********##%#@@###%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+++***+**####%%@@@@@@@@@@@@@@@@@@@@@@%***++++********+++++++++++*****###**###*#%%%#%%%%%%%%@%%##%@@#*******+++=+==+++++++++++++***++*##%@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
++++**++**#%%%%@@@@@@@@@@@@@@@@@@@@@@%#***+*++***#*+**+**++++++++++++=++*+++****#***######%%@#**#@#*+=+++++==+++++++++++++++++++*****##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
++++**+++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@##**++++*##%@%%#%*++=+++++===++++++++=++++++=+**+++++*#%=-=**===-=====+=====+++++++++++++***#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*+++***++*#%##%%@@@@@@@@@@@@@@@@@@@@@@###*+*++*##%%%#%++++*+===++++==========-=+===+====-=--=*#+=*++=============++++++++++*+*++*##%%@%@@@%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*++++**++*####%%@@@@@@@@@@@@@@@@@@@@@%%%##***++++*#####%%#+++++==+====+=+======++===+%*=-==-==#%==+=====-==*++======+++++++++**#%%%%@@@@@%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
++==+**++*####%%@@@@@@@@@@@@@@@@@@@@@@%%%@%#*+**++++++*#******++++++==+++=====-====*%@*+++++++#%*+++=+=+=-=+#++=+====++++*****#%%%@@@@@%%####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
++==+++++*####%%@@@@@@@@@@@@@@@@@@@@@%+#%##*+***++===+++*####*#**+++==*+=+++=-=***###+=-::==-::---::-----====*###**++++++*#%%%%@@@@@@@%%####%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+*+++++++*#**###%@@@@@@@@@@@@@@@@@@@@%*##%@@####**++++++*##*##*#%%****+**+++***+-=-::----=--:***=-:*#*-=#+:*=--:-=*####%%%@@@@@@@@@@%######%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
***+=++++****###%@@@@@@@@@@@@@@@@@@@@@**#%%@@%###***+++++**++*#%%@@%@@###*==--=--#*#=-=#*-.::*+=.:-**=:++:-*#=---*=:--=*#@@%%@%%%%##**#####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
##*+====+****###%@@@@@@@@@@@@@@@@@@@@@#**#%%@@@@@@%#*###**++*####%%%%##+-:=#%=:-:*+=::-**-::-**--:=*+--*--**+:::+*=-#%*--=+%##%##***+*#*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
%#*+====+****###%%@@@@@@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@@@%##*######%*++#+--:=*+--.+#+:--++-=-=+%:::+*=-*=-***:=:+*=-**=:=#%*==+*******#%#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@%#*+====+***###%%@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@%@@%%#+=--#++:-:-++:--+**-=-**==-=+*::-*+-=+-=+#:=:+*:-*+=:+#*=--*+:-+*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@%#*==-=+++*##*#%%@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@@*=-+@#:-#*=-=-+*=::=+*---*#==-++=::=*+=+-=+*==:+*-=+*+=***--=##*=--:-#%%@@@@@@@@%#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%
@@@%#+=-=+++****##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=:*#-=#+--**-=:-+=--:#*==-+**+-**+--**=++-*#**-+*-=*#==++*::**#=-+*#*-:-+@@@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#
@@@@%#+===+++*#*##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@#=+*=:-+:+#--+++==:*+:-:*#*==+**=-**=:-#=-*==**=:=*-=#*=+**+:+*#*-+**+::-:=-:*%@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*
@@@@@%*+=++++*#*###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@%=-*#*=---+.**:-*+++-+*--:+**=-*#*==##-:*#-+=-#%+:+%:+#+-=**==+#=:=*##----=++**::=*%%@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#**
@@@@@@#*+++++*#**###@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+*@*:-*#=-:=+:+*:+#+*=:*+-:=@#--*%=:*#*:-%=-+-*%+:+#:=%+:#%=-+#*-+##*--:-*++*:::::++=%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*++
@@@@@@%%*+++++*#**##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%-.***+:-+#+-:==:*+-+**+-+*::-%#--*%=:*%=:+#:+-+%*-=*:+@==#*:=%*--*%#*-:-+**+::-:=*++**--:::+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#**++
@@@@@@@@%#*++++***##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+=%*:=#*+--+**-:=--*=-*#=::%---#%+-+%+-#%--%-=+=##==+:#%:=%+-*#=-#%#+=:-##+-:::=***+---:-+*#+:+%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#**+++*
@@@@@@@@@%#*+++***##%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*:-:=*+--*##=:++#+:---*:=##-:+*.:*%*-+%+=#*:=*-+-#%+=+-#*-#*:+#==*%%+::*%#=::-+****-::-+*+*#+--:-=%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*++++*#
@@@@@@@@@@%#******###%@@@@@@@@@@@@@@@@@@@@@@@@@@#-:*#*-:=*=--*+=:++#*--:=*-+#*--#:-=%#-+%++#=:*-==+@+===#+=%=-#+-+##+--#%+-:-+**#*=::+++#++-::-=+#*:+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#**+++*##
@@@@@@@@@@@@%*****##%%@@@@@@@@@@@@@@@@@@@@@@@@@%#=::=***--++--+#+:-%%*::-==-*#+:+=--%#=+%=**--*-==#=-==*=++:+*-+%%=-=#*=:-+*%#=-=+##+=-::-=+*++#*==*-*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#**+++++*#%
@@@@@@@@@@@@@%#****##%%@@@@@@@@@@@@@@@@@@@@@@@##+--:.-=*#*-=*=-=#*-:*%*-::+--##==*-=%#-+*=+=:+-=-*====+=+-=*-+%#=-+#=--+%#=--+##*+---++%*+#*+=-==::--:=%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*+++=++*#%@
@@@@@@@@@@@@@@%##**###%@@@@@@@@@@@@@@@@@@@@@@#*=-++:-:::=+*=-++-:*#-.*@#---=-+%*:+--*+-===+-----++======-+-=#+-=++-=+*+--+#*+=--=*##%#**#*---::--=+*%#:+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*++===++*#%%@
@@@@@@@@@@@@@@@%%#####%%@@@@@@@@@@@@@@@@@@@@@*=:=*++=:--.:=++--*+:=%+:+@#---=-#*===++*++++*+===+%==++=-=-=+=-=====+===++=--+*#%%@%*=-----=++***+*#*+=*==%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%##*+====++*#%@@@
@@@@@@@@@@@@@@@@@%%###%%@@@@@@@@@@@@@@@@@@@@@*=:.:-+++=-:::-=*+-=*--**-+%#+=++*#****#%*###*****%#**++=++++=-==-==-----==#@@%#*+--==+*#%%*#%#+==---:=+*=-+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#*+======+*#%%@@@
@@@@@@@@@@@@@@@@@@@%%#%%@@@@@@@@@@@@@@@@@@@@@#--=-::-=+++==-:-+*=-**=#%*+%%*#%#%%%%%@@%%@%%%%%%%%#######***++++=++*#***++=+++*#%@@%%#++=-===++****#**%#--*@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*++=--===+*#%%@@@@
@@@@@@@@@@@@@@@@@@@@%%%%%@@@@@@@@@@@@@@@@@@@@+:-==+-::::=+**=::=*%##%%@@+-*+==+#%@@@@@@@@@@@@@@@@@@@@%%%%%%###**+==+#%%%%%@@@#++==++*##%#*##**+++==---+=-=#@@@@@@@@@@@@@@@@@@@@@@@@@%%#*+=----==+*#%@@@@@@
@@@@@@@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@@@@@@@@%:::..:-++-:::-+##+--+@@@@@@#==++=---#+==#%=++===+--=======--=----=*#%%%%#*++++**#%%@@@@#**####*++++**+----+--=#@@@@@@@@@@@@@@@@@@@@@@@%#*+=---::-=+*#%%@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@@@@@@#::::::.::-==--:-+*##=:-#%%%+-==+*=--=*==*#-=============--=+***+*+++++****+****#%#*++++=++#*********+-=---+-==#@@@@@@@@@@@@@@@@@@@@%%%#*==---:--=+*#%%%@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@%=++=-:.::::.:-=+=--=#%#=:=#*-----+%=--+==+*=====-====+++++++=++++**%@@@%#*******####****##*#*+++===----=-==++==#@@@@@@@@@@@@@@@@@@@%%#*+=-------=+*#%@%@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@#:===++==--:::..:-++=--*#*=-=+=----=%=-====*=======--++++**+###%#***#**#%@#+=+*++#@###+=+===+=#%%%#*=-===-===*==*%@@@@@@@@@@@@@@@@@%%*+==--:::--=+*#%%%@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*:::..:-==*---::::::-++=-=*#===+==-==#+====*========+@@%#####*+*++++=+#%@@#*=*%**@@@###+====**@%%%%%*=====-=-+=-=#@@@@@@@@@@@@@@@%#**+=----::-=+*#%%%%%@@@@@@@@
 */
using System;
using System.IO;
using System.Management;
using System.Security.Cryptography;
using System.Text;
namespace Assist.Shared.Services.Utils;





public class MotionCat
{
    public static string Encrypt(string text, string passcode)
    {
        using (Aes aesAlg = Aes.Create())
        {
            aesAlg.KeySize = 256;
            aesAlg.Key = GetValidKey(passcode, aesAlg.KeySize);
            aesAlg.IV = new byte[16];

            ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);

            using (MemoryStream msEncrypt = new MemoryStream())
            {
                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                {
                    using (StreamWriter swEncrypt = new StreamWriter(csEncrypt))
                    {
                        swEncrypt.Write(text);
                    }
                }
                return Convert.ToBase64String(msEncrypt.ToArray());
            }
        }
    }
    public static string Decrypt(string cipherText, string passcode)
    {
        using (Aes aesAlg = Aes.Create())
        {
            aesAlg.KeySize = 256;
            aesAlg.Key = GetValidKey(passcode, aesAlg.KeySize);
            aesAlg.IV = new byte[16]; // Use the same IV used for encryption

            ICryptoTransform decryptor = aesAlg.CreateDecryptor(aesAlg.Key, aesAlg.IV);

            using (MemoryStream msDecrypt = new MemoryStream(Convert.FromBase64String(cipherText)))
            {
                using (CryptoStream csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))
                {
                    using (StreamReader srDecrypt = new StreamReader(csDecrypt))
                    {
                        return srDecrypt.ReadToEnd();
                    }
                }
            }
        }
    }
    public static string GetHardwareId()
    {
        string processorId = GetProcessorId();
        string motherboardId = GetMotherboardId();

        // Combine the processorId and motherboardId to create a unique hardware ID
        string combinedId = $"{processorId}-{motherboardId}";

        // Hash the combined ID to create a more secure and consistent identifier
        string hardwareId = ComputeHash(combinedId);

        return hardwareId;
    }
    static string GetProcessorId()
    {
        using (ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT ProcessorId FROM Win32_Processor"))
        {
            ManagementObjectCollection collection = searcher.Get();
            foreach (ManagementObject obj in collection)
            {
                return obj["ProcessorId"].ToString();
            }
        }
        return string.Empty;
    }
    public static string GetMotherboardId()
    {
        using (ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT SerialNumber FROM Win32_BaseBoard"))
        {
            ManagementObjectCollection collection = searcher.Get();
            foreach (ManagementObject obj in collection)
            {
                return obj["SerialNumber"].ToString();
            }
        }
        return string.Empty;
    }
    static string ComputeHash(string input)
    {
        using (SHA256 sha256 = SHA256.Create())
        {
            byte[] hashBytes = sha256.ComputeHash(Encoding.UTF8.GetBytes(input));
            StringBuilder stringBuilder = new StringBuilder();
            foreach (byte b in hashBytes)
            {
                stringBuilder.Append(b.ToString("x2"));
            }
            return stringBuilder.ToString();
        }
    }
    
    static byte[] GetValidKey(string passcode, int keySize)
    {
        // Derive a key using a key derivation function (KDF)
        using (var deriveBytes = new Rfc2898DeriveBytes(passcode, Encoding.UTF8.GetBytes("SALT1234"), 10000))
        {
            return deriveBytes.GetBytes(keySize / 8);
        }
    }
}